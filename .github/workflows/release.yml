name: release

on:
  push: { tags: ["*"] }

permissions:
  contents: write

jobs:
  checks:
    uses: ./.github/workflows/ci.yml

  release:
    runs-on: ubuntu-latest
    needs: checks
    steps:
      - name: checkout
        uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8
      - name: setup-go
        uses: actions/setup-go@44694675825211faa026b3c33043df3e48a5fa00
        with: { go-version: "1.25" }
      - name: release
        uses: goreleaser/goreleaser-action@e435ccd777264be153ace6237001ef4d979d3a7a
        with:
          version: v2.12
          args: release --clean
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
